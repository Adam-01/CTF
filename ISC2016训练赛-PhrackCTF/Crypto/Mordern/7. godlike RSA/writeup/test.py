import gmpy2
import rsa
import libnum

# openssl rsa -pubin -text -modulus -in pubkey.pem

e = 65537

# yafu.exe factor(87924348264132406875276140514499937145050893665602592992418171647042491658461)
p = 30061432003658510087798871614869318011389940352798147030129806359975911392091235344042288409629143229311060231549478211871643725394470760528211801310601767727834886942210718412087541234398453046895030858579989874035849439867334906873642352112428914855967993998732685221108379784833027771293275558876952608462050146340591449046825135890871650866799299533696175818103240024841274114925018619060818213433528894936128306780366785977567327073724428211445259983614467640785163297734447975723664659822673456683284394386723716344090232882990461174301609971805075768328757325956784604364401827152431260896927633163074694121679
q = 26136662545551829820746942051638228325025130519175536694008242208616774469870765684858288042819063837180243501117310278632509413217676559484513481677689042623348188876598901642459170232360966754692434316796014314498263800234390539118817050074978421973817764644287745302885861277447227180288605200894138168586207384484170481511828680117688324729381172912436910052489279406590356734739774635376711681212908417321705094537960645308009611045658947359297373154395500467689532455017647450616447445444254910371922944620114234547655209970657063715028350418518417105772707885648587233103869340985670430269862943630137067052883
n = p * q
fn = (p - 1) * (q - 1)

d = int(gmpy2.invert(e, fn))

# rsa模块制作私钥
prikey = rsa.PrivateKey(n, e, d, p, q)

with open('flag.enc', 'rb') as f:
    c = f.read()
print(c)
m = rsa.decrypt(c, prikey).decode()
print(m)
